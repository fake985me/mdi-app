import{c as M,r as m,A as J,q as K,o as Q,b as a,d as t,k as b,e as P,f as p,v as n,x,y as C,F as k,h as w,l as A,t as u,B as Z,N as q,i as r,m as X,n as Y}from"./main-wl1HvSEI.js";import{u as ee}from"./warehouse-BR82cYcQ.js";import{P as te}from"./plus-CcN--E47.js";import{P as se}from"./pen-CWp7rWkd.js";import{T as le}from"./trash-2-DD-7q0V3.js";import"./api-D6uEPlNO.js";/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=M("box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=M("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=M("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),ue={class:"p-6"},ne={class:"flex justify-between items-center mb-8"},ie={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},de={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},me=["value"],ce=["disabled"],be=["value"],ge={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},pe={class:"flex justify-between items-center"},fe={class:"flex space-x-3"},ye={key:0,class:"mt-3"},ve={class:"w-full bg-gray-200 rounded-full h-2.5"},xe={class:"text-sm text-gray-600 mt-1"},ke={key:1,class:"mt-3 p-3 bg-gray-50 rounded-md"},we={key:0,class:"text-sm text-green-600"},_e={key:1,class:"text-sm text-red-600"},he={key:0,class:"mt-1 list-disc list-inside"},Pe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},Ce={class:"h-48 bg-gray-100 flex items-center justify-center"},Se=["src","alt"],Ue={class:"p-4"},Me={class:"flex justify-between items-start mb-2"},Ve={class:"font-semibold text-gray-900 truncate"},je={class:"flex space-x-1"},Ie=["onClick"],Fe=["onClick"],Ae={class:"mb-2"},qe={class:"text-sm text-gray-600"},Be={key:0,class:"text-sm text-gray-500"},Ee={class:"text-xs text-gray-500 mb-3"},Le={class:"space-y-2"},Ne={class:"flex justify-between"},Te={class:"text-sm font-medium text-green-600"},ze={class:"flex justify-between"},Ge={class:"flex justify-between"},$e={class:"text-sm text-gray-900"},Oe={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},De={class:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto"},Re={class:"text-lg font-semibold text-gray-900 mb-4"},We=["value"],He=["disabled"],Je=["value"],Ke={class:"flex space-x-4 mb-3"},Qe={class:"flex items-center"},Ze={class:"flex items-center"},Xe={key:0,class:"space-y-2"},Ye={key:0,class:"w-full bg-gray-200 rounded-full h-2"},et={key:1},tt={key:2,class:"mt-3"},st={class:"relative inline-block"},lt=["src"],ot={class:"flex justify-end space-x-4"},rt={type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"},bt={__name:"ProductsPage",setup(at){const i=ee(),U=m(!1),f=m(null),y=m("upload"),c=m(0),_=m(""),h=m(""),V=m(""),S=m(""),o=J({name:"",sku:"",category_id:"",subcategory_id:"",price:0,current_stock:0,minimum_stock:0,image_url:""}),j=m(null),v=m(0),d=m(null),B=()=>{j.value.click()},E=async l=>{const e=l.target.files[0];if(e)try{d.value=null,v.value=10;const s=await i.importProducts(e);v.value=100,d.value=s,setTimeout(()=>{v.value=0},3e3)}catch(s){v.value=0,d.value={success:!1,message:s.message||"Import failed"}}},L=async()=>{try{const l=await i.exportProducts();d.value=l}catch(l){d.value={success:!1,message:l.message||"Export failed"}}},N=K(()=>{let l=i.products;return _.value&&(l=l.filter(e=>e.name.toLowerCase().includes(_.value.toLowerCase())||e.sku.toLowerCase().includes(_.value.toLowerCase()))),h.value&&(l=l.filter(e=>e.category_id===h.value)),S.value==="low"?l=l.filter(e=>e.current_stock<=e.minimum_stock):S.value==="out"&&(l=l.filter(e=>e.current_stock===0)),l}),T=(l,e)=>l===0?"text-red-600":l<=e?"text-orange-600":"text-green-600",z=()=>{},G=l=>{f.value=l,Object.assign(o,{name:l.name,sku:l.sku,category_id:l.category_id,subcategory_id:l.subcategory_id||"",price:l.price,current_stock:l.current_stock,minimum_stock:l.minimum_stock,image_url:l.image_url})},$=async l=>{confirm("Are you sure you want to delete this product?")&&await i.deleteProduct(l)},O=async l=>{const e=l.target.files[0];if(e){if(e.size>5*1024*1024){alert("File size must be less than 5MB");return}if(!["image/jpeg","image/png","image/gif","image/webp"].includes(e.type)){alert("Please select a valid image file (JPG, PNG, GIF, WebP)");return}c.value=10;const g=await i.uploadImage(e);c.value=100,g.success?(o.image_url=g.url,setTimeout(()=>{c.value=0},1e3)):(alert("Failed to upload image: "+g.error),c.value=0)}},D=()=>{console.warn("Failed to load image:",o.image_url)},R=()=>{o.image_url="",c.value=0},W=async()=>{f.value?await i.updateProduct(f.value.id,o):await i.createProduct(o),I()},I=()=>{U.value=!1,f.value=null,y.value="upload",c.value=0,Object.assign(o,{name:"",sku:"",category_id:"",subcategory_id:"",price:0,current_stock:0,minimum_stock:0,image_url:""})};return Q(async()=>{await i.fetchProducts(),await i.fetchCategories(),await i.fetchSubcategories()}),(l,e)=>(r(),a("div",ue,[t("div",ne,[e[16]||(e[16]=t("div",null,[t("h1",{class:"text-3xl font-bold text-gray-900"},"Products"),t("p",{class:"text-gray-600"},"Manage your product inventory")],-1)),t("button",{onClick:e[0]||(e[0]=s=>U.value=!0),class:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2"},[P(p(te),{class:"w-5 h-5"}),e[15]||(e[15]=t("span",null,"Add Product",-1))])]),t("div",ie,[t("div",de,[t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Search",-1)),n(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>_.value=s),type:"text",placeholder:"Search products...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[x,_.value]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Category",-1)),n(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>h.value=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},[e[18]||(e[18]=t("option",{value:""},"All Categories",-1)),(r(!0),a(k,null,w(p(i).categories,s=>(r(),a("option",{key:s.id,value:s.id},u(s.name),9,me))),128))],512),[[C,h.value]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Subcategory",-1)),n(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>V.value=s),disabled:!h.value,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed"},[e[20]||(e[20]=t("option",{value:""},"All Subcategories",-1)),(r(!0),a(k,null,w(l.filteredSubcategories,s=>(r(),a("option",{key:s.id,value:s.id},u(s.name),9,be))),128))],8,ce),[[C,V.value]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Stock Status",-1)),n(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>S.value=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},e[22]||(e[22]=[t("option",{value:""},"All Items",-1),t("option",{value:"low"},"Low Stock",-1),t("option",{value:"out"},"Out of Stock",-1)]),512),[[C,S.value]])])])]),t("div",ge,[t("div",pe,[e[26]||(e[26]=t("h2",{class:"text-xl font-semibold text-gray-900"},"Import/Export Products",-1)),t("div",fe,[t("button",{onClick:B,class:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2"},[P(p(ae),{class:"w-5 h-5"}),e[24]||(e[24]=t("span",null,"Import Products",-1))]),t("button",{onClick:L,class:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2"},[P(p(re),{class:"w-5 h-5"}),e[25]||(e[25]=t("span",null,"Export Products",-1))]),t("input",{ref_key:"fileInput",ref:j,type:"file",accept:".xlsx,.xls,.csv",class:"hidden",onChange:E},null,544)])]),v.value?(r(),a("div",ye,[t("div",ve,[t("div",{class:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:A({width:v.value+"%"})},null,4)]),t("p",xe,u(v.value)+"% Complete",1)])):b("",!0),d.value?(r(),a("div",ke,[d.value.success?(r(),a("p",we,u(d.value.message),1)):(r(),a("div",_e,[t("p",null,u(d.value.message),1),d.value.errors&&d.value.errors.length>0?(r(),a("ul",he,[(r(!0),a(k,null,w(d.value.errors,(s,g)=>(r(),a("li",{key:g,class:"text-xs"},u(s),1))),128))])):b("",!0)]))])):b("",!0)]),t("div",Pe,[(r(!0),a(k,null,w(N.value,s=>{var g,F;return r(),a("div",{key:s.id,class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow"},[t("div",Ce,[s.image_url?(r(),a("img",{key:0,src:s.image_url,alt:s.name,class:"w-full h-full object-cover"},null,8,Se)):(r(),X(p(oe),{key:1,class:"w-16 h-16 text-gray-400"}))]),t("div",Ue,[t("div",Me,[t("h3",Ve,u(s.name),1),t("div",je,[t("button",{onClick:H=>G(s),class:"text-blue-600 hover:text-blue-800 p-1"},[P(p(se),{class:"w-4 h-4"})],8,Ie),t("button",{onClick:H=>$(s.id),class:"text-red-600 hover:text-red-800 p-1"},[P(p(le),{class:"w-4 h-4"})],8,Fe)])]),t("div",Ae,[t("span",qe,u((g=s.categories)==null?void 0:g.name),1),(F=s.subcategories)!=null&&F.name?(r(),a("span",Be," / "+u(s.subcategories.name),1)):b("",!0)]),t("p",Ee,"SKU: "+u(s.sku),1),t("div",Le,[t("div",Ne,[e[27]||(e[27]=t("span",{class:"text-sm text-gray-600"},"Price:",-1)),t("span",Te,"$"+u(s.price),1)]),t("div",ze,[e[28]||(e[28]=t("span",{class:"text-sm text-gray-600"},"Stock:",-1)),t("span",{class:Y(["text-sm font-medium",T(s.current_stock,s.minimum_stock)])},u(s.current_stock),3)]),t("div",Ge,[e[29]||(e[29]=t("span",{class:"text-sm text-gray-600"},"Min Stock:",-1)),t("span",$e,u(s.minimum_stock),1)])])])])}),128))]),U.value||f.value?(r(),a("div",Oe,[t("div",De,[t("h3",Re,u(f.value?"Edit Product":"Add New Product"),1),t("form",{onSubmit:Z(W,["prevent"]),class:"space-y-4"},[t("div",null,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Name",-1)),n(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>o.name=s),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[x,o.name]])]),t("div",null,[e[31]||(e[31]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"SKU",-1)),n(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>o.sku=s),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[x,o.sku]])]),t("div",null,[e[33]||(e[33]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Category",-1)),n(t("select",{"onUpdate:modelValue":e[7]||(e[7]=s=>o.category_id=s),onChange:z,required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},[e[32]||(e[32]=t("option",{value:""},"Select Category",-1)),(r(!0),a(k,null,w(p(i).categories,s=>(r(),a("option",{key:s.id,value:s.id},u(s.name),9,We))),128))],544),[[C,o.category_id]])]),t("div",null,[e[35]||(e[35]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Subcategory",-1)),n(t("select",{"onUpdate:modelValue":e[8]||(e[8]=s=>o.subcategory_id=s),disabled:!o.category_id,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed"},[e[34]||(e[34]=t("option",{value:""},"Select Subcategory (Optional)",-1)),(r(!0),a(k,null,w(l.availableSubcategories,s=>(r(),a("option",{key:s.id,value:s.id},u(s.name),9,Je))),128))],8,He),[[C,o.subcategory_id]])]),t("div",null,[e[36]||(e[36]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Price",-1)),n(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>o.price=s),type:"number",step:"0.01",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[x,o.price]])]),t("div",null,[e[37]||(e[37]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Current Stock",-1)),n(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>o.current_stock=s),type:"number",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[x,o.current_stock]])]),t("div",null,[e[38]||(e[38]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Minimum Stock",-1)),n(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>o.minimum_stock=s),type:"number",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[x,o.minimum_stock]])]),t("div",null,[e[43]||(e[43]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Product Image",-1)),t("div",Ke,[t("label",Qe,[n(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>y.value=s),type:"radio",value:"upload",class:"mr-2"},null,512),[[q,y.value]]),e[39]||(e[39]=t("span",{class:"text-sm"},"Upload File",-1))]),t("label",Ze,[n(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>y.value=s),type:"radio",value:"url",class:"mr-2"},null,512),[[q,y.value]]),e[40]||(e[40]=t("span",{class:"text-sm"},"Image URL",-1))])]),y.value==="upload"?(r(),a("div",Xe,[t("input",{onChange:O,type:"file",accept:"image/jpeg,image/png,image/gif,image/webp",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,32),e[41]||(e[41]=t("p",{class:"text-xs text-gray-500"},"Max size: 5MB. Formats: JPG, PNG, GIF, WebP",-1)),c.value>0&&c.value<100?(r(),a("div",Ye,[t("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:A(`width: ${c.value}%`)},null,4)])):b("",!0)])):b("",!0),y.value==="url"?(r(),a("div",et,[n(t("input",{"onUpdate:modelValue":e[14]||(e[14]=s=>o.image_url=s),type:"url",placeholder:"https://example.com/image.jpg",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[x,o.image_url]]),e[42]||(e[42]=t("p",{class:"text-xs text-gray-500 mt-1"},"Enter a direct link to an image",-1))])):b("",!0),o.image_url?(r(),a("div",tt,[t("div",st,[t("img",{src:o.image_url,alt:"Product preview",class:"w-32 h-32 object-cover rounded-lg border border-gray-300",onError:D},null,40,lt),t("button",{type:"button",onClick:R,class:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600"}," × ")])])):b("",!0)]),t("div",ot,[t("button",{type:"button",onClick:I,class:"px-4 py-2 text-gray-600 hover:text-gray-800"}," Cancel "),t("button",rt,u(f.value?"Update":"Add")+" Product ",1)])],32)])])):b("",!0)]))}};export{bt as default};
