import{q as N,r as b,s as F,J as g,o as T,b as u,d as e,k as D,e as f,f as c,t as n,x as d,y as i,K as v,F as _,h,v as E,i as a,n as Q}from"./main-wp7H4zy9.js";import{u as z}from"./warehouse-BgDV8_UP.js";import{P as I}from"./plus-D_kl3TaN.js";import{A as J}from"./arrow-left-right-Cf-0ffYC.js";import{T as K}from"./triangle-alert-B2GCNcpL.js";import{C as W}from"./circle-check-big-CvWFmipv.js";import"./api-D6uEPlNO.js";const G={class:"p-6"},H={class:"flex justify-between items-center mb-8"},X={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},Y={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},Z={class:"flex items-center justify-between"},ee={class:"text-2xl font-bold text-blue-600"},te={class:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center"},re={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},se={class:"flex items-center justify-between"},oe={class:"text-2xl font-bold text-red-600"},ne={class:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center"},le={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},de={class:"flex items-center justify-between"},ue={class:"text-2xl font-bold text-green-600"},ae={class:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center"},ie={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},ce={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},pe=["value"],me={class:"bg-white rounded-lg shadow-sm border border-gray-200"},xe={class:"overflow-x-auto"},be={class:"w-full"},ge={class:"bg-white divide-y divide-gray-200"},fe={class:"px-6 py-4 whitespace-nowrap"},ye={class:"text-sm font-medium text-gray-900"},we={class:"text-sm text-gray-500"},ve={class:"px-6 py-4 whitespace-nowrap"},_e={class:"text-sm font-medium text-gray-900"},he={class:"text-sm text-gray-500"},ke={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Be={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Se={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Ce={class:"px-6 py-4 whitespace-nowrap"},Ae={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},De=["onClick"],Ve=["onClick"],qe=["onClick"],Re={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},je={class:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto"},Pe=["value"],Ee={__name:"BorrowingsPage",setup(Ue){const l=z(),V=N(),y=b(!1),p=b(""),m=b(""),x=b(""),o=F({product_id:"",borrower_name:"",borrower_contact:"",quantity:1,borrow_date:new Date().toISOString().split("T")[0],expected_return_date:"",notes:"",created_by:null}),q=g(()=>l.borrowings.filter(s=>s.status==="active").length),R=g(()=>l.borrowings.filter(s=>s.status==="overdue").length),j=g(()=>l.borrowings.filter(s=>s.status==="returned").length),P=g(()=>{let s=l.borrowings;if(p.value&&(s=s.filter(t=>{var r;return t.borrower_name.toLowerCase().includes(p.value.toLowerCase())||((r=t.products)==null?void 0:r.name)&&t.products.name.toLowerCase().includes(p.value.toLowerCase())})),m.value)if(m.value==="overdue"){const t=new Date;s=s.filter(r=>r.status==="active"&&new Date(r.expected_return_date)<t)}else s=s.filter(t=>t.status===m.value);return x.value&&(s=s.filter(t=>t.product_id===x.value)),s}),k=s=>{if(s.status==="returned")return"Returned";const t=new Date;return new Date(s.expected_return_date)<t?"Overdue":"Active"},U=s=>{const t=k(s);return{Active:"bg-blue-100 text-blue-800",Overdue:"bg-red-100 text-red-800",Returned:"bg-green-100 text-green-800"}[t]},w=s=>new Date(s).toLocaleDateString(),M=s=>{var t;alert(`Borrowing Details:
Product: ${(t=s.products)==null?void 0:t.name}
Borrower: ${s.borrower_name}
Quantity: ${s.quantity}
Expected Return: ${w(s.expected_return_date)}`)},$=async s=>{confirm("Mark this borrowing as returned?")&&await l.returnBorrowing(s)},L=async s=>{confirm("Are you sure you want to delete this borrowing?")&&await l.deleteBorrowing(s)},O=async()=>{var s;o.created_by=(s=V.profile)==null?void 0:s.id,await l.createBorrowing(o),B()},B=()=>{y.value=!1,Object.assign(o,{product_id:"",borrower_name:"",borrower_contact:"",quantity:1,borrow_date:new Date().toISOString().split("T")[0],expected_return_date:"",notes:"",created_by:null})};return T(async()=>{await l.fetchBorrowings(),await l.fetchProducts()}),(s,t)=>(a(),u("div",G,[e("div",H,[t[12]||(t[12]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Borrowings"),e("p",{class:"text-gray-600"},"Manage item borrowing and returns")],-1)),e("button",{onClick:t[0]||(t[0]=r=>y.value=!0),class:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center space-x-2"},[f(c(I),{class:"w-5 h-5"}),t[11]||(t[11]=e("span",null,"Add Borrowing",-1))])]),e("div",X,[e("div",Y,[e("div",Z,[e("div",null,[t[13]||(t[13]=e("p",{class:"text-sm font-medium text-gray-600"},"Active Borrowings",-1)),e("p",ee,n(q.value),1)]),e("div",te,[f(c(J),{class:"w-6 h-6 text-blue-600"})])])]),e("div",re,[e("div",se,[e("div",null,[t[14]||(t[14]=e("p",{class:"text-sm font-medium text-gray-600"},"Overdue",-1)),e("p",oe,n(R.value),1)]),e("div",ne,[f(c(K),{class:"w-6 h-6 text-red-600"})])])]),e("div",le,[e("div",de,[e("div",null,[t[15]||(t[15]=e("p",{class:"text-sm font-medium text-gray-600"},"Returned",-1)),e("p",ue,n(j.value),1)]),e("div",ae,[f(c(W),{class:"w-6 h-6 text-green-600"})])])])]),e("div",ie,[e("div",ce,[e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Search",-1)),d(e("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>p.value=r),type:"text",placeholder:"Search borrowings...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[i,p.value]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Status",-1)),d(e("select",{"onUpdate:modelValue":t[2]||(t[2]=r=>m.value=r),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},t[17]||(t[17]=[e("option",{value:""},"All Status",-1),e("option",{value:"active"},"Active",-1),e("option",{value:"overdue"},"Overdue",-1),e("option",{value:"returned"},"Returned",-1)]),512),[[v,m.value]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Product",-1)),d(e("select",{"onUpdate:modelValue":t[3]||(t[3]=r=>x.value=r),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},[t[19]||(t[19]=e("option",{value:""},"All Products",-1)),(a(!0),u(_,null,h(c(l).products,r=>(a(),u("option",{key:r.id,value:r.id},n(r.name),9,pe))),128))],512),[[v,x.value]])])])]),e("div",me,[e("div",xe,[e("table",be,[t[21]||(t[21]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Product "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Borrower "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Quantity "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Borrow Date "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Expected Return "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",ge,[(a(!0),u(_,null,h(P.value,r=>{var S,C;return a(),u("tr",{key:r.id,class:"hover:bg-gray-50"},[e("td",fe,[e("div",ye,n((S=r.products)==null?void 0:S.name),1),e("div",we,n((C=r.products)==null?void 0:C.sku),1)]),e("td",ve,[e("div",_e,n(r.borrower_name),1),e("div",he,n(r.borrower_contact||"N/A"),1)]),e("td",ke,n(r.quantity),1),e("td",Be,n(w(r.borrow_date)),1),e("td",Se,n(w(r.expected_return_date)),1),e("td",Ce,[e("span",{class:Q(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",U(r)])},n(k(r)),3)]),e("td",Ae,[r.status==="active"?(a(),u("button",{key:0,onClick:A=>$(r.id),class:"text-green-600 hover:text-green-900 mr-3"}," Mark Returned ",8,De)):D("",!0),e("button",{onClick:A=>M(r),class:"text-blue-600 hover:text-blue-900 mr-3"}," View ",8,Ve),e("button",{onClick:A=>L(r.id),class:"text-red-600 hover:text-red-900"}," Delete ",8,qe)])])}),128))])])])]),y.value?(a(),u("div",Re,[e("div",je,[t[31]||(t[31]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Add Borrowing",-1)),e("form",{onSubmit:E(O,["prevent"]),class:"space-y-4"},[e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Product",-1)),d(e("select",{"onUpdate:modelValue":t[4]||(t[4]=r=>o.product_id=r),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},[t[22]||(t[22]=e("option",{value:""},"Select Product",-1)),(a(!0),u(_,null,h(c(l).products,r=>(a(),u("option",{key:r.id,value:r.id},n(r.name)+" ("+n(r.sku)+") ",9,Pe))),128))],512),[[v,o.product_id]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Borrower Name",-1)),d(e("input",{"onUpdate:modelValue":t[5]||(t[5]=r=>o.borrower_name=r),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[i,o.borrower_name]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Borrower Contact",-1)),d(e("input",{"onUpdate:modelValue":t[6]||(t[6]=r=>o.borrower_contact=r),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[i,o.borrower_contact]])]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Quantity",-1)),d(e("input",{"onUpdate:modelValue":t[7]||(t[7]=r=>o.quantity=r),type:"number",min:"1",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[i,o.quantity]])]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Borrow Date",-1)),d(e("input",{"onUpdate:modelValue":t[8]||(t[8]=r=>o.borrow_date=r),type:"date",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[i,o.borrow_date]])]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Expected Return Date",-1)),d(e("input",{"onUpdate:modelValue":t[9]||(t[9]=r=>o.expected_return_date=r),type:"date",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[i,o.expected_return_date]])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Notes",-1)),d(e("textarea",{"onUpdate:modelValue":t[10]||(t[10]=r=>o.notes=r),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[i,o.notes]])]),e("div",{class:"flex justify-end space-x-4"},[e("button",{type:"button",onClick:B,class:"px-4 py-2 text-gray-600 hover:text-gray-800"}," Cancel "),t[30]||(t[30]=e("button",{type:"submit",class:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700"}," Add Borrowing ",-1))])],32)])])):D("",!0)]))}};export{Ee as default};
