import{q,r as x,s as U,J as T,o as A,b as a,d as e,k as B,e as L,f as k,x as n,y as m,K as g,N as S,F as h,h as _,v as N,i as u,t as r,n as F}from"./main-wp7H4zy9.js";import{u as j}from"./warehouse-BgDV8_UP.js";import{P as O}from"./plus-D_kl3TaN.js";import"./api-D6uEPlNO.js";const Q={class:"p-6"},R={class:"flex justify-between items-center mb-8"},$={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},z={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},I={class:"bg-white rounded-lg shadow-sm border border-gray-200"},E={class:"overflow-x-auto"},J={class:"w-full"},K={class:"bg-white divide-y divide-gray-200"},W={class:"px-6 py-4 whitespace-nowrap"},G={class:"text-sm font-medium text-gray-900"},H={class:"text-sm text-gray-500"},X={class:"px-6 py-4 whitespace-nowrap"},Y={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Z={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ee={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},te={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},oe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},se={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},le={class:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto"},re=["value"],pe={__name:"StockMovementsPage",setup(ne){const i=j(),M=q(),y=x(!1),d=x(""),c=x(""),b=x(""),s=U({product_id:"",movement_type:"",quantity:1,unit_price:0,notes:"",created_by:null}),V=T(()=>{let l=i.stockMovements;return d.value&&(l=l.filter(t=>{var o,p;return((o=t.products)==null?void 0:o.name.toLowerCase().includes(d.value.toLowerCase()))||((p=t.products)==null?void 0:p.sku.toLowerCase().includes(d.value.toLowerCase()))})),c.value&&(l=l.filter(t=>t.movement_type===c.value)),b.value&&(l=l.filter(t=>new Date(t.created_at).toDateString()===new Date(b.value).toDateString())),l}),C=l=>({incoming:"bg-green-100 text-green-800",outgoing:"bg-red-100 text-red-800",purchase:"bg-blue-100 text-blue-800",sale:"bg-purple-100 text-purple-800",borrow:"bg-orange-100 text-orange-800",return:"bg-teal-100 text-teal-800"})[l]||"bg-gray-100 text-gray-800",D=l=>new Date(l).toLocaleDateString(),P=async()=>{var l;s.created_by=(l=M.profile)==null?void 0:l.id,s.total_amount=s.quantity*(s.unit_price||0),await i.createStockMovement(s),f()},f=()=>{y.value=!1,Object.assign(s,{product_id:"",movement_type:"",quantity:1,unit_price:0,notes:"",created_by:null})};return A(async()=>{await i.fetchStockMovements(),await i.fetchProducts()}),(l,t)=>(u(),a("div",Q,[e("div",R,[t[10]||(t[10]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Stock Movements"),e("p",{class:"text-gray-600"},"Track all inventory movements and transactions")],-1)),e("button",{onClick:t[0]||(t[0]=o=>y.value=!0),class:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2"},[L(k(O),{class:"w-5 h-5"}),t[9]||(t[9]=e("span",null,"Add Movement",-1))])]),e("div",$,[e("div",z,[e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Search",-1)),n(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>d.value=o),type:"text",placeholder:"Search movements...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[m,d.value]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Movement Type",-1)),n(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>c.value=o),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},t[12]||(t[12]=[S('<option value="">All Types</option><option value="incoming">Incoming</option><option value="outgoing">Outgoing</option><option value="purchase">Purchase</option><option value="sale">Sale</option><option value="borrow">Borrow</option><option value="return">Return</option>',7)]),512),[[g,c.value]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Date Range",-1)),n(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>b.value=o),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[m,b.value]])])])]),e("div",I,[e("div",E,[e("table",J,[t[15]||(t[15]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Product "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Type "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Quantity "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Unit Price "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Total Amount "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Date "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Created By ")])],-1)),e("tbody",K,[(u(!0),a(h,null,_(V.value,o=>{var p,v,w;return u(),a("tr",{key:o.id,class:"hover:bg-gray-50"},[e("td",W,[e("div",G,r((p=o.products)==null?void 0:p.name),1),e("div",H,r((v=o.products)==null?void 0:v.sku),1)]),e("td",X,[e("span",{class:F(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",C(o.movement_type)])},r(o.movement_type),3)]),e("td",Y,r(o.quantity),1),e("td",Z," $"+r(o.unit_price||"0.00"),1),e("td",ee," $"+r(o.total_amount||"0.00"),1),e("td",te,r(D(o.created_at)),1),e("td",oe,r(((w=o.profiles)==null?void 0:w.full_name)||"System"),1)])}),128))])])])]),y.value?(u(),a("div",se,[e("div",le,[t[24]||(t[24]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Add Stock Movement",-1)),e("form",{onSubmit:N(P,["prevent"]),class:"space-y-4"},[e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Product",-1)),n(e("select",{"onUpdate:modelValue":t[4]||(t[4]=o=>s.product_id=o),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},[t[16]||(t[16]=e("option",{value:""},"Select Product",-1)),(u(!0),a(h,null,_(k(i).products,o=>(u(),a("option",{key:o.id,value:o.id},r(o.name)+" ("+r(o.sku)+") ",9,re))),128))],512),[[g,s.product_id]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Movement Type",-1)),n(e("select",{"onUpdate:modelValue":t[5]||(t[5]=o=>s.movement_type=o),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},t[18]||(t[18]=[S('<option value="">Select Type</option><option value="incoming">Incoming</option><option value="outgoing">Outgoing</option><option value="purchase">Purchase</option><option value="sale">Sale</option><option value="borrow">Borrow</option><option value="return">Return</option>',7)]),512),[[g,s.movement_type]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Quantity",-1)),n(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>s.quantity=o),type:"number",min:"1",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[m,s.quantity]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Unit Price",-1)),n(e("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>s.unit_price=o),type:"number",step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[m,s.unit_price]])]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Notes",-1)),n(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=o=>s.notes=o),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[m,s.notes]])]),e("div",{class:"flex justify-end space-x-4"},[e("button",{type:"button",onClick:f,class:"px-4 py-2 text-gray-600 hover:text-gray-800"}," Cancel "),t[23]||(t[23]=e("button",{type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"}," Add Movement ",-1))])],32)])])):B("",!0)]))}};export{pe as default};
